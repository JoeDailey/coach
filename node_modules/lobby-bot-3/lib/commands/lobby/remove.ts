import { SlashSubcommand } from "discord-slash"
import { CommandInteraction, GuildMember } from "discord.js"
import { Channel, Lobby } from "../../lobbies"

export default new SlashSubcommand(
  "remove",
  "Remove a player from the lobby",
  handle,
  cmd => cmd
    .addUserOption(member => member
      .setName('member')
      .setDescription('Player to add')
      .setRequired(true)
    ),
);

async function handle(interaction: CommandInteraction) {
  const user = interaction.options.getMember('member');
  const channel = interaction.channel as Channel;
  const lobby = await Lobby.get(channel);
  lobby.removePlayers(user as GuildMember);
  await interaction.reply(await lobby.print(channel));
}
